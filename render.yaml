# Render Blueprint - Infrastructure as Code
# https://render.com/docs/infrastructure-as-code

services:
  - type: web
    name: agromate-api
    runtime: python
    region: oregon  # Closest to South America
    plan: free
    
    # Build configuration
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn main:app --host 0.0.0.0 --port $PORT
    
    # Health check
    healthCheckPath: /health
    
    # Environment variables (set these in Render dashboard for security)
    envVars:
      - key: PYTHON_VERSION
        value: "3.11"
      - key: SUPABASE_URL
        sync: false  # Set manually in dashboard
      - key: SUPABASE_ANON_KEY
        sync: false  # Set manually in dashboard
      - key: GOOGLE_API_KEY
        sync: false  # Set manually in dashboard

    # Auto-deploy on push to main branch
    autoDeploy: true
    branch: main
    
    # Root directory (if backend is in subfolder)
    rootDir: backend
